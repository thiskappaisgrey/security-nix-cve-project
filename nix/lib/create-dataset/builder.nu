# For now, read the packages environment variable and
# echo it to a file

def log [
  msg: string # The message to log.
] { $"(ansi green)+(ansi reset) ($msg)" }

def err [
  msg: string # The message to log.
] { $"(ansi red)+(ansi reset) ($msg)" }

log "Starting build script"

let packages = $env.packages | split row ' '
let out = $env.out
mkdir $"($out)"
# For each package, I want to copy the binary to out
# but I need the name..? Or maybe I can just copy *
for pkg in $packages {
        let s = $"($pkg)/bin/*" 
        # ls $s | save $"($out)/pkgs-list.txt"  --append
        cp $s $"($out)" 
        $s | save $"($out)/pkgs-list.txt"  --append
        "\n" | save $"($out)/pkgs-list.txt"  --append
}
# echo $packages | save $"($out)/pkgs-list.txt" 
